{% extends "base.html" %}


{% block content %}
  {% if posts %}
    <form method="get">
    {{ form.sort_by.label_tag }} {{ form.sort_by }}
    <button type="submit">Sort</button>
</form>
    {% for post in posts %}

      <div class="message">
        <div class="post-info">
          <p class="user-name">
            {{ post.user.username }}
          </p>
          <p class="date-info">
            {{ post.formatted_date }}
          </p>

        </div>
        <p class="text-area">
          {{ post.text }}
        </p>
        <p class="comment-link">
          <a href="{% url "blog:add_comment" post_id=post.id %}">Comment</a>
        </p>
      </div>
      <br>
      {% if post.comments %}
        {% for comment in post.comments.all %}
          <div class="message">
            <div class="post-info">
              <p class="user-name">
                {{ comment.user.username }}
              </p>
              <p class="date-info">
                {{ comment.formatted_date }}
              </p>

            </div>
            <p class="text-area">
              {{ comment.text }}
            </p>
            <div>
              <p class="comment-link">
                <a href="{% url "blog:add_comment" post_id=post.id %}">Comment</a>
              </p>
            </div>
          </div>
          <br>
        {% endfor %}
      {% endif %}
    {% endfor %}
  {% endif %}
  <div>
    <a href="{% url "blog:add_post" %}">
      Create post
    </a>
  </div>
{% endblock %}

